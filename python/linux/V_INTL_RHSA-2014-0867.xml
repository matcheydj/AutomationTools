<?xml version="1.0"?>
<Vulnerability xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" Lang="INTL" Vul_ID="RHSA-2014-0867" Revision="2" CVE_ID="CVE-2014-0178,CVE-2014-0244,CVE-2014-3493">
  <Status>Deleted</Status>
  <Groups />
  <DependsOn />
  <Patches>
    <Patch UniqueFilename="*samba-common-4.1.1-35.el7_0.x86_64.rpm" Hash="" Silent="CRSNo" Reboot="RNo" Download="DManual">
      <Name>samba-common-4.1.1-35.el7_0.x86_64.rpm</Name>
      <Comments />
      <URL />
      <State>Enabled</State>
      <Files>
        <File>
          <Path>samba-common::x86_64</Path>
          <FileDate>0001-01-01T00:00:00.0000000+00:00</FileDate>
          <FileSize>0</FileSize>
          <Checksum>b5edaa43e2c4c368a81c86c00ae45aed</Checksum>
          <Version>4.1.1-35.el7_0</Version>
          <CommandID>e</CommandID>
          <Flags>P</Flags>
        </File>
      </Files>
      <RegKeys />
      <Products>
        <ID>33203</ID>
      </Products>
      <Platforms>
        <ID>rhel7_x86_64</ID>
      </Platforms>
      <CustVars />
      <Cmds>
        <Cmd Type="shellscript">
          <Args>
            <Arg N="scriptcode" V="#!/bin/bash&#xA;&#xA;function updatepk()&#xA;{&#xA; if [ ! -z $1 ]; then&#xA;   if [ -e /var/run/yum.pid ];then &#xA;    exit 10  &#xA;   fi&#xA;   result=`yum -y update $1 2&gt;&amp;1` &#xA;   status=$? &#xA;   commandexist=`echo $result | grep -E &quot;yum: command not found&quot;`&#xA;   if [ &quot;$commandexist&quot; != &quot;&quot; ]; then&#xA;     exit 8&#xA;   fi&#xA;   &#xA;    commandexist=`echo $result | grep -E &quot;yum: No such file or directory&quot;`&#xA;   if [ &quot;$commandexist&quot; != &quot;&quot; ]; then&#xA;     exit 8&#xA;   fi&#xA;   &#xA;   islock=`echo $result | grep -E &quot;lock /var/run/yum.pid&quot;`&#xA;   &#xA;   if [ &quot;$islock&quot; != &quot;&quot; ]; then&#xA;     exit 10&#xA;   fi&#xA;   &#xA;   islock=`echo $result | grep -E &quot;/var/run/yum.pid: another copy is running&quot;`&#xA;   &#xA;   if [ &quot;$islock&quot; != &quot;&quot; ]; then&#xA;     exit 10&#xA;   fi&#xA;   &#xA;   isnotconnected=`echo $result | grep -E &quot;There was an error communicating with RHN&quot;`&#xA;   if [ &quot;$isnotconnected&quot; != &quot;&quot; ]; then&#xA;     exit 9&#xA;   fi&#xA;   &#xA;   isnotconnected=`echo $result | grep -E &quot;This system is not registered with RHN&quot;`&#xA;   if [ &quot;$isnotconnected&quot; != &quot;&quot; ]; then&#xA;     exit 9&#xA;   fi&#xA;   &#xA;    isnotconnected=`echo $result | grep -E &quot;No Repositories Available to Set Up&quot;`&#xA;   if [ &quot;$isnotconnected&quot; != &quot;&quot; ]; then&#xA;     exit 9&#xA;   fi&#xA;    isnotconnected=`echo $result | grep -E &quot;Error Class Code: 9 Error Class Info: Invalid System Credentials&quot;`&#xA;   if [ &quot;$isnotconnected&quot; != &quot;&quot; ]; then&#xA;     exit 9&#xA;   fi&#xA;    isscriptletfailed=`echo $result | grep -E &quot;error:&quot; | grep -E &quot;scriptlet failed, exit status 255&quot;`&#xA;    if [ &quot;$isscriptletfailed&quot; != &quot;&quot; ]; then&#xA;     exit 6&#xA;   fi&#xA;   if [ $status -ne 0 ];then&#xA;     exit 7&#xA;   fi &#xA; fi&#xA;}&#xA;updatepk samba-common  &#xA;&#xA;exit 0" />
          </Args>
        </Cmd>
      </Cmds>
    </Patch>
    <Patch UniqueFilename="*samba-pidl-4.1.1-35.el7_0.x86_64.rpm" Hash="" Silent="CRSNo" Reboot="RNo" Download="DManual">
      <Name>samba-pidl-4.1.1-35.el7_0.x86_64.rpm</Name>
      <Comments />
      <URL />
      <State>Enabled</State>
      <Files>
        <File>
          <Path>samba-pidl::x86_64</Path>
          <FileDate>0001-01-01T00:00:00.0000000+00:00</FileDate>
          <FileSize>0</FileSize>
          <Checksum>388ef181eba8462bab826769fd6fd043</Checksum>
          <Version>4.1.1-35.el7_0</Version>
          <CommandID>e</CommandID>
          <Flags>P</Flags>
        </File>
      </Files>
      <RegKeys />
      <Products>
        <ID>33209</ID>
      </Products>
      <Platforms>
        <ID>rhel7_x86_64</ID>
      </Platforms>
      <CustVars />
      <Cmds>
        <Cmd Type="shellscript">
          <Args>
            <Arg N="scriptcode" V="#!/bin/bash&#xA;&#xA;function updatepk()&#xA;{&#xA; if [ ! -z $1 ]; then&#xA;   if [ -e /var/run/yum.pid ];then &#xA;    exit 10  &#xA;   fi&#xA;   result=`yum -y update $1 2&gt;&amp;1` &#xA;   status=$? &#xA;   commandexist=`echo $result | grep -E &quot;yum: command not found&quot;`&#xA;   if [ &quot;$commandexist&quot; != &quot;&quot; ]; then&#xA;     exit 8&#xA;   fi&#xA;   &#xA;    commandexist=`echo $result | grep -E &quot;yum: No such file or directory&quot;`&#xA;   if [ &quot;$commandexist&quot; != &quot;&quot; ]; then&#xA;     exit 8&#xA;   fi&#xA;   &#xA;   islock=`echo $result | grep -E &quot;lock /var/run/yum.pid&quot;`&#xA;   &#xA;   if [ &quot;$islock&quot; != &quot;&quot; ]; then&#xA;     exit 10&#xA;   fi&#xA;   &#xA;   islock=`echo $result | grep -E &quot;/var/run/yum.pid: another copy is running&quot;`&#xA;   &#xA;   if [ &quot;$islock&quot; != &quot;&quot; ]; then&#xA;     exit 10&#xA;   fi&#xA;   &#xA;   isnotconnected=`echo $result | grep -E &quot;There was an error communicating with RHN&quot;`&#xA;   if [ &quot;$isnotconnected&quot; != &quot;&quot; ]; then&#xA;     exit 9&#xA;   fi&#xA;   &#xA;   isnotconnected=`echo $result | grep -E &quot;This system is not registered with RHN&quot;`&#xA;   if [ &quot;$isnotconnected&quot; != &quot;&quot; ]; then&#xA;     exit 9&#xA;   fi&#xA;   &#xA;    isnotconnected=`echo $result | grep -E &quot;No Repositories Available to Set Up&quot;`&#xA;   if [ &quot;$isnotconnected&quot; != &quot;&quot; ]; then&#xA;     exit 9&#xA;   fi&#xA;    isnotconnected=`echo $result | grep -E &quot;Error Class Code: 9 Error Class Info: Invalid System Credentials&quot;`&#xA;   if [ &quot;$isnotconnected&quot; != &quot;&quot; ]; then&#xA;     exit 9&#xA;   fi&#xA;    isscriptletfailed=`echo $result | grep -E &quot;error:&quot; | grep -E &quot;scriptlet failed, exit status 255&quot;`&#xA;    if [ &quot;$isscriptletfailed&quot; != &quot;&quot; ]; then&#xA;     exit 6&#xA;   fi&#xA;   if [ $status -ne 0 ];then&#xA;     exit 7&#xA;   fi &#xA; fi&#xA;}&#xA;updatepk samba-pidl  &#xA;&#xA;exit 0" />
          </Args>
        </Cmd>
      </Cmds>
    </Patch>
  </Patches>
  <PublishDate>2014-07-09T00:00:00.0000000+00:00</PublishDate>
  <Title>Moderate: samba security update</Title>
  <Description>Updated samba packages that fix three security issues are now available for 
 Red Hat Enterprise Linux 7. 
 
 The Red Hat Security Response Team has rated this update as having Moderate 
 security impact. Common Vulnerability Scoring System (CVSS) base scores, 
 which give detailed severity ratings, are available for each vulnerability 
 from the CVE links in the References section. 
 Samba is an open-source implementation of the Server Message Block (SMB) or 
 Common Internet File System (CIFS) protocol, which allows PC-compatible 
 machines to share files, printers, and other information. 
 
 A denial of service flaw was found in the way the sys_recvfile() function 
 of nmbd, the NetBIOS message block daemon, processed non-blocking sockets. 
 An attacker could send a specially crafted packet that, when processed, 
 would cause nmbd to enter an infinite loop and consume an excessive amount 
 of CPU time. (CVE-2014-0244) 
 
 A flaw was found in the way Samba created responses for certain 
 authenticated client requests when a shadow-copy VFS module was enabled. 
 An attacker able to send an authenticated request could use this flaw to 
 disclose limited portions of memory per each request. (CVE-2014-0178) 
 
 It was discovered that smbd, the Samba file server daemon, did not properly 
 handle certain files that were stored on the disk and used a valid Unicode 
 character in the file name. An attacker able to send an authenticated 
 non-Unicode request that attempted to read such a file could cause smbd to 
 crash. (CVE-2014-3493) 
 
 Red Hat would like to thank Daniel Berteaud of FIREWALL-SERVICES SARL for 
 reporting CVE-2014-0244, and the Samba project for reporting CVE-2014-0178 
 and CVE-2014-3493. The Samba project acknowledges Christof Schmitt as the 
 original reporter of CVE-2014-0178, and Simon Arlott as the original 
 reporter of CVE-2014-3493. 
 
 All Samba users are advised to upgrade to these updated packages, which 
 contain backported patches to correct these issues. After installing this 
 update, the smb service will be restarted automatically. 
 
 Note for remediation: Please disable the SELinux for RHEL 4/5 when repairing, or some rpm packages will fail to install.</Description>
  <Severity>3</Severity>
  <Vendor>Redhat</Vendor>
  <MoreInfoURL>https://rhn.redhat.com/errata/RHSA-2014-0867.html</MoreInfoURL>
  <FAQURL />
</Vulnerability>